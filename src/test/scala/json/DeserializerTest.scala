package json

import Deserializer.fromJson
import org.scalatest.FunSuite
import org.scalatest.Assertions._
import example1.Tweet
import example1.Hashtag

case class UnaClase(unString: String, unOption: Option[Int])

class DeserializerTest extends FunSuite {

  test("puedo deserializar una clase") {
    assert(
      fromJson[UnaClase]("""{"unString":"hola","unOption":null}""") == UnaClase("hola", None)
    )
  }

  test("puedo deserializar un tweet") {
    val tweetJson = """{"created_at":"Mon Nov 10 16:20:02 +0000 2014","id":531843735492239360,"id_str":"531843735492239360","text":"RT @Weidknecht: Celebrate Family Milestones With @Netflix #StreamTeam #Partner http://t.co/ABjClBFZnW via @ToughCookieMom","source":"<a href=\"http://bufferapp.com\" rel=\"nofollow\">Buffer</a>","truncated":false,"in_reply_to_status_id":null,"in_reply_to_status_id_str":null,"in_reply_to_user_id":null,"in_reply_to_user_id_str":null,"in_reply_to_screen_name":null,"user":{"id":1320469512,"id_str":"1320469512","name":"TXWomenBloggers","screen_name":"TXWomenBloggers","location":"Texas","url":"http://www.texaswomenbloggers.com/","description":"The gathering place to make friends with other Texas women bloggers, share stories and experiences and be inspired! Tweets by @pnkheelspnktrk","protected":false,"verified":false,"followers_count":2608,"friends_count":2866,"listed_count":53,"favourites_count":355,"statuses_count":5133,"created_at":"Mon Apr 01 14:43:37 +0000 2013","utc_offset":-21600,"time_zone":"Central Time (US & Canada)","geo_enabled":false,"lang":"en","contributors_enabled":false,"is_translator":false,"profile_background_color":"C7E4DF","profile_background_image_url":"http://abs.twimg.com/images/themes/theme1/bg.png","profile_background_image_url_https":"https://abs.twimg.com/images/themes/theme1/bg.png","profile_background_tile":false,"profile_link_color":"41AD9A","profile_sidebar_border_color":"FFFFFF","profile_sidebar_fill_color":"DDEEF6","profile_text_color":"333333","profile_use_background_image":false,"profile_image_url":"http://pbs.twimg.com/profile_images/3471250822/e5f3784c6697c18687717e21f69128c3_normal.png","profile_image_url_https":"https://pbs.twimg.com/profile_images/3471250822/e5f3784c6697c18687717e21f69128c3_normal.png","profile_banner_url":"https://pbs.twimg.com/profile_banners/1320469512/1364999164","default_profile":false,"default_profile_image":false,"following":null,"follow_request_sent":null,"notifications":null},"geo":null,"coordinates":null,"place":null,"contributors":null,"retweeted_status":{"created_at":"Mon Nov 10 13:19:04 +0000 2014","id":531798193345134592,"id_str":"531798193345134592","text":"Celebrate Family Milestones With @Netflix #StreamTeam #Partner http://t.co/ABjClBFZnW via @ToughCookieMom","source":"<a href=\"http://triberr.com\" rel=\"nofollow\">Triberr</a>","truncated":false,"in_reply_to_status_id":null,"in_reply_to_status_id_str":null,"in_reply_to_user_id":null,"in_reply_to_user_id_str":null,"in_reply_to_screen_name":null,"user":{"id":331418917,"id_str":"331418917","name":"Lisa Weidknecht MAEd","screen_name":"Weidknecht","location":"Elgin, TX","url":"http://www.weidknecht.com","description":"Planet Weidknecht Blogger - #home, #travel, #recipes, #tech, #family, #reviews, #giveaways, #Jesus, #NASCAR, #Austin, #Texas","protected":false,"verified":false,"followers_count":21094,"friends_count":8996,"listed_count":195,"favourites_count":8301,"statuses_count":89729,"created_at":"Fri Jul 08 04:18:23 +0000 2011","utc_offset":-21600,"time_zone":"Central Time (US & Canada)","geo_enabled":true,"lang":"en","contributors_enabled":false,"is_translator":false,"profile_background_color":"0099B9","profile_background_image_url":"http://abs.twimg.com/images/themes/theme4/bg.gif","profile_background_image_url_https":"https://abs.twimg.com/images/themes/theme4/bg.gif","profile_background_tile":false,"profile_link_color":"009AB9","profile_sidebar_border_color":"5ED4DC","profile_sidebar_fill_color":"95E8EC","profile_text_color":"3C3940","profile_use_background_image":true,"profile_image_url":"http://pbs.twimg.com/profile_images/2476390869/xa3ok8qvpb8kjkevpa4a_normal.jpeg","profile_image_url_https":"https://pbs.twimg.com/profile_images/2476390869/xa3ok8qvpb8kjkevpa4a_normal.jpeg","profile_banner_url":"https://pbs.twimg.com/profile_banners/331418917/1404790446","default_profile":false,"default_profile_image":false,"following":null,"follow_request_sent":null,"notifications":null},"geo":null,"coordinates":null,"place":null,"contributors":null,"retweet_count":2,"favorite_count":0,"entities":{"hashtags":[{"text":"StreamTeam","indices":[42,53]},{"text":"Partner","indices":[54,62]}],"trends":[],"urls":[{"url":"http://t.co/ABjClBFZnW","expanded_url":"http://goo.gl/KOOwJb","display_url":"goo.gl/KOOwJb","indices":[63,85]}],"user_mentions":[{"screen_name":"netflix","name":"Netflix US","id":16573941,"id_str":"16573941","indices":[33,41]},{"screen_name":"ToughCookieMom","name":"Maria Castro","id":44507218,"id_str":"44507218","indices":[90,105]}],"symbols":[]},"favorited":false,"retweeted":false,"possibly_sensitive":false,"filter_level":"low","lang":"en"},"retweet_count":0,"favorite_count":0,"entities":{"hashtags":[{"text":"StreamTeam","indices":[58,69]},{"text":"Partner","indices":[70,78]}],"trends":[],"urls":[{"url":"http://t.co/ABjClBFZnW","expanded_url":"http://goo.gl/KOOwJb","display_url":"goo.gl/KOOwJb","indices":[79,101]}],"user_mentions":[{"screen_name":"Weidknecht","name":"Lisa Weidknecht MAEd","id":331418917,"id_str":"331418917","indices":[3,14]},{"screen_name":"netflix","name":"Netflix US","id":16573941,"id_str":"16573941","indices":[49,57]},{"screen_name":"ToughCookieMom","name":"Maria Castro","id":44507218,"id_str":"44507218","indices":[106,121]}],"symbols":[]},"favorited":false,"retweeted":false,"possibly_sensitive":false,"filter_level":"medium","lang":"en","timestamp_ms":"1415636402453","smx":{"clients":[],"source_id":"531843735492239360","type":"STATUS","origin_hostname":"http://ananke.dc.smx.la","crawled_time":1415636402540,"acl":"PUBLIC","location":{"country":"united states","city":"dallas","state":"texas","latitude":null,"longitude":null}}}"""
    assert(
      fromJson[Tweet](tweetJson).entities.hashtags == Set(Hashtag("StreamTeam"), Hashtag("Partner"))
    )
  }

  test("puedo deserializar un retweet") {
    val retweetJson = """{"created_at":"Mon Nov 10 16:20:03 +0000 2014","id":531843739195817984,"id_str":"531843739195817984","text":"RT @AeroMexico_com: ¡Disfruta dos vuelos diarios a  Houston! Incrementamos la conectividad con Texas desde @omaeropuertos. http://t.co/W4aB…","source":"<a href=\"http://tweetadder.com\" rel=\"nofollow\">TweetAdder v4</a>","truncated":false,"in_reply_to_status_id":null,"in_reply_to_status_id_str":null,"in_reply_to_user_id":null,"in_reply_to_user_id_str":null,"in_reply_to_screen_name":null,"user":{"id":2321387785,"id_str":"2321387785","name":"Javier Nuñez","screen_name":"JaviElectronico","location":"México","url":null,"description":"Apasianado del fútbol #Chelsea y la capacidad de adaptar los avances tecnológicos en mi vida profesional y cotidiana. No hay nada mejor que #Apple","protected":false,"verified":false,"followers_count":1037,"friends_count":29,"listed_count":0,"favourites_count":2,"statuses_count":1139,"created_at":"Fri Jan 31 21:35:22 +0000 2014","utc_offset":-21600,"time_zone":"Mexico City","geo_enabled":false,"lang":"es","contributors_enabled":false,"is_translator":false,"profile_background_color":"C0DEED","profile_background_image_url":"http://pbs.twimg.com/profile_background_images/431839528261652482/nT4yE_Mt.jpeg","profile_background_image_url_https":"https://pbs.twimg.com/profile_background_images/431839528261652482/nT4yE_Mt.jpeg","profile_background_tile":false,"profile_link_color":"0084B4","profile_sidebar_border_color":"FFFFFF","profile_sidebar_fill_color":"DDEEF6","profile_text_color":"333333","profile_use_background_image":true,"profile_image_url":"http://pbs.twimg.com/profile_images/431839222433976320/G-OWnwVX_normal.jpeg","profile_image_url_https":"https://pbs.twimg.com/profile_images/431839222433976320/G-OWnwVX_normal.jpeg","profile_banner_url":"https://pbs.twimg.com/profile_banners/2321387785/1391793479","default_profile":false,"default_profile_image":false,"following":null,"follow_request_sent":null,"notifications":null},"geo":null,"coordinates":null,"place":null,"contributors":null,"retweeted_status":{"created_at":"Mon Nov 10 15:59:56 +0000 2014","id":531838676372688896,"id_str":"531838676372688896","text":"¡Disfruta dos vuelos diarios a  Houston! Incrementamos la conectividad con Texas desde @omaeropuertos. http://t.co/W4aBQBXdAU","source":"<a href=\"http://twitter.com\" rel=\"nofollow\">Twitter Web Client</a>","truncated":false,"in_reply_to_status_id":null,"in_reply_to_status_id_str":null,"in_reply_to_user_id":null,"in_reply_to_user_id_str":null,"in_reply_to_screen_name":null,"user":{"id":50505691,"id_str":"50505691","name":"Aeroméxico","screen_name":"AeroMexico_com","location":"All around the globe.","url":"http://www.aeromexico.com","description":"La línea que nos une. Conoce nuestra Política de Privacidad en: http://vuela.am/13TlSSN","protected":false,"verified":true,"followers_count":665569,"friends_count":271523,"listed_count":2290,"favourites_count":353,"statuses_count":25587,"created_at":"Thu Jun 25 01:15:36 +0000 2009","utc_offset":-21600,"time_zone":"Mexico City","geo_enabled":false,"lang":"es","contributors_enabled":false,"is_translator":false,"profile_background_color":"FFFFFF","profile_background_image_url":"http://pbs.twimg.com/profile_background_images/461909749903003649/2gF5e583.png","profile_background_image_url_https":"https://pbs.twimg.com/profile_background_images/461909749903003649/2gF5e583.png","profile_background_tile":false,"profile_link_color":"215EA9","profile_sidebar_border_color":"FFFFFF","profile_sidebar_fill_color":"9AE4E8","profile_text_color":"333333","profile_use_background_image":false,"profile_image_url":"http://pbs.twimg.com/profile_images/517343083277455360/4lFyiWfN_normal.png","profile_image_url_https":"https://pbs.twimg.com/profile_images/517343083277455360/4lFyiWfN_normal.png","profile_banner_url":"https://pbs.twimg.com/profile_banners/50505691/1415633491","default_profile":false,"default_profile_image":false,"following":null,"follow_request_sent":null,"notifications":null},"geo":null,"coordinates":null,"place":null,"contributors":null,"retweet_count":5,"favorite_count":1,"entities":{"hashtags":[],"trends":[],"urls":[{"url":"http://t.co/W4aBQBXdAU","expanded_url":"http://vuela.am/1rT4y7t","display_url":"vuela.am/1rT4y7t","indices":[103,125]}],"user_mentions":[{"screen_name":"OMAeropuertos","name":"OMA ","id":132342145,"id_str":"132342145","indices":[87,101]}],"symbols":[]},"favorited":false,"retweeted":false,"possibly_sensitive":false,"filter_level":"low","lang":"es"},"retweet_count":0,"favorite_count":0,"entities":{"hashtags":[],"trends":[],"urls":[{"url":"http://t.co/W4aBQBXdAU","expanded_url":"http://vuela.am/1rT4y7t","display_url":"vuela.am/1rT4y7t","indices":[139,140]}],"user_mentions":[{"screen_name":"AeroMexico_com","name":"Aeroméxico","id":50505691,"id_str":"50505691","indices":[3,18]},{"screen_name":"OMAeropuertos","name":"OMA ","id":132342145,"id_str":"132342145","indices":[107,121]}],"symbols":[]},"favorited":false,"retweeted":false,"possibly_sensitive":false,"filter_level":"medium","lang":"es","timestamp_ms":"1415636403292","smx":{"clients":[],"source_id":"531843739195817984","type":"STATUS","origin_hostname":"http://ananke.dc.smx.la","crawled_time":1415636403369,"acl":"PUBLIC","location":{"country":"mexico","city":"mexico","state":"distrito federal","latitude":null,"longitude":null}}}"""
    assert(
      fromJson[Tweet](retweetJson).retweeted_status.get.user.screen_name == "AeroMexico_com"
    )
  }

}
